<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>New webpage</title>
        <style>
            body {
                background-color:#dde0ff;
                text-align:center;
            }
            button {
                background-color:#02e8f1;
                color:#b0abc2;
                font-family:cursive;
            }
            .todo-text {
                font-family:fantasy;
            }
            h1,h3 {
                font-family:cursive;
            }
            #htmldiv {
                background-color:#c9f7ea;
                border-radius:13%;
            }
        </style>
    </head>
    <body>
<div id="htmldiv">
<h1>Mini todo listðŸ“‹</h1>
<p>Create your todo list here!</p>
<button id="add-a-task-btn">Add a task</button>
</div>

<script>
  var tasks = []  
  var savedTasks = localStorage.getItem("tasks");
if (savedTasks) {
    tasks = JSON.parse(savedTasks);
}

/* --------------------------------------------------
   ADDED FOR LOOP â€” SHOW SAVED TASKS ON PAGE LOAD
-------------------------------------------------- */
for (let i = 0; i < tasks.length; i++) {
    var taskObj = tasks[i];

    var newHeading = document.createElement("h3");
    newHeading.innerText = taskObj.text;

    var checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.checked = taskObj.checked;

    var taskDiv = document.createElement("div");
    taskDiv.style.display = "flex";
    taskDiv.style.alignItems = "center";
    taskDiv.style.gap = "8px";

    taskDiv.appendChild(checkbox);
    taskDiv.appendChild(newHeading);
    document.body.appendChild(taskDiv);

    checkbox.addEventListener("change", function() {
        tasks[i].checked = checkbox.checked;
        localStorage.setItem("tasks", JSON.stringify(tasks));

        if (checkbox.checked) {
            newHeading.style.textDecoration = "line-through";
            newHeading.style.opacity = "0.6";
        } else {
            newHeading.style.textDecoration = "none";
            newHeading.style.opacity = "1";
        }
    });

    if (taskObj.checked) {
        newHeading.style.textDecoration = "line-through";
        newHeading.style.opacity = "0.6";
    }
}
/* -------------------------------------------------- */


    var TaskButton = document.getElementById("add-a-task-btn");

    var TaskButtonClick = function () {

        // Create heading only once
        if (!document.getElementById("task-heading")) {
            var heading = document.createElement("h3");
            heading.id = "task-heading";
            heading.innerHTML = "Write your task in the input below";
            document.body.appendChild(heading);
        }

        // Always add a new input
        var input = document.createElement("input");
        input.type = "text";
        input.placeholder = "New task...";
        document.body.appendChild(input);

        // Make an okay button
        var okbtn = document.createElement("button");
        okbtn.textContent = "OK";
        okbtn.id = "okbtnid";
        document.body.appendChild(okbtn);

        okbtn.addEventListener("click", function() {
            var text = input.value;
            var newHeading = document.createElement("h3");
            newHeading.innerText = text; 

            // FIX: checkbox right next to the text
            var checkbox = document.createElement("input");
            checkbox.type = "checkbox";

            // Make a row container for checkbox + text
            var taskDiv = document.createElement("div");
            taskDiv.style.display = "flex";
            taskDiv.style.alignItems = "center";
            taskDiv.style.gap = "8px";

            taskDiv.appendChild(checkbox);
            taskDiv.appendChild(newHeading);

            document.body.appendChild(taskDiv);

            // Check-off behavior
            checkbox.addEventListener("change", function() {
                if (checkbox.checked) {
                    newHeading.style.textDecoration = "line-through";
                    newHeading.style.opacity = "0.6";
                } else {
                    newHeading.style.textDecoration = "none";
                    newHeading.style.opacity = "1";
                }
            });

            // Remove input + OK button + instructions
            input.remove();
            okbtn.remove();
            var instructionHeading = document.getElementById("task-heading");
            if (instructionHeading) instructionHeading.remove();
        
            // Save new task
            tasks.push({
                text: text,
                checked: false
            });
            localStorage.setItem("tasks", JSON.stringify(tasks));
        });

    };

    TaskButton.addEventListener("click", TaskButtonClick);
</script>
    </body>
</html>
